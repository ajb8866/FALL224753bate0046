---
title: "Lab 5"
author: "Averi Bastes"
date: "`r Sys.Date()` "
output:
  html_document:
    toc: yes 
    toc_float: yes 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Tasks 

## Task 1 

```{r}
getwd()
```


## Task 2

```{r}
mybin=function(iter=100,n=10, p=0.5){ 
  
sam.mat=matrix(NA,nr=n,nc=iter, byrow=TRUE)

succ=c()
for( i in 1:iter){

sam.mat[,i]=sample(c(1,0),n,replace=TRUE, prob=c(p,1-p))

succ[i]=sum(sam.mat[,i])
}

succ.tab=table(factor(succ,levels=0:n))

barplot(succ.tab/(iter), col=rainbow(n+1), main="Binomial Simulation", xlab="Number of Successes")
succ.tab/iter
}


```


### iter = 100 n = 10 p = 0.7
```{r}

bin100 = mybin(iter=100,n=10, p=0.7)

```



### iter = 200 n = 10  p= 0.7
```{r}

bin200 = mybin(iter=200,n=10, p=0.7)

```


### iter = 500 n = 10 p = 0.7
```{r}

bin500 = mybin(iter=500,n=10, p=0.7)

```


### iter = 1000 n = 10 p = 0.7 

```{r}

bin1000 = mybin(iter=1000,n=10, p=0.7)

```


### iter = 10,000 n = 10 p = 0.7 
```{r}

bin10000= mybin(iter=10000,n=10, p=0.7)

```



### Table for Iter 10,0000

```{r}
bin10000
```



```{r}
dbinom10000=round(dbinom(0:10, size= 10, prob= 0.7), 4)
names(dbinom10000) = 0:10
dbinom10000
```

As seen in the two table, the numbers at each point are very close to one another. This implies that the two agree with each other. The more iteration of mybin there are the closer the numbers will be to the actual value. 


## Task 3 

```{r}
tab <- sample(c(1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0),size=5,prob= NULL, replace= FALSE)
tab
```
```{r}
tab <-sample(c(1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0), size = 5, prob= NULL, replace= TRUE)
tab
```

```{r}
myhyper=function(iter=100,N=20,r=12,n=5){

sam.mat=matrix(NA,nr=n,nc=iter, byrow=TRUE)
succ=c()
for( i in 1:iter){

sam.mat[,i]=sample(rep(c(1,0),c(r,N-r)),n,replace=FALSE)

succ[i]=sum(sam.mat[,i])
}
# Make table of successes
succ.tab=table(factor(succ,levels=0:n))

barplot(succ.tab/(iter), col=rainbow(n+1), main="Hypergeometric Simulation", xlab="Number of Successes")
succ.tab/iter
}


```


```{r}
myhyper1= myhyper(iter=100, N=20,r=12, n = 5)
```

```{r}
myhyper2= myhyper(iter=200, N=20,r=12, n = 5)
```

```{r}
myhyper3= myhyper(iter=500,N=20,r=12, n=5)
```

```{r}
myhyper4= myhyper(iter=1000, N=20,r=12, n=5)
```

```{r}
myhyper5= myhyper(iter=10000, N=20,r=12, n=5)
```


```{r}
dhyper10000= round(dhyper(x= 0:10, m= 12, k=6 , n= 5 ), 4) 
names(dhyper10000)= 0:10 
dhyper10000
```

There is a similar issue as in Task 2 the numbers in both tables are close, but not exactly the same. Like before more iterations of myhyper there are the closer the number will be to the actual value. 

## Task 4 

```{r}
mysample=function(n, iter=10,time=0.5){
for( i in 1:iter){
# Make a sample
s=sample(1:10,n,replace=TRUE)

sf=factor(s,levels=1:10)
# Make a barplot
barplot(table(sf)/n,beside=TRUE,col=rainbow(10), 
main=paste("Example Sample()", " iteration", i, " n = ", n,sep="") ,
ylim=c(0,0.2)
)
Sys.sleep(time)
}
}

mysample(n=1000,time=1, iter=1)
```
We can see plots are mostly identical between each other, due to the repeated experimental iterations. This confirms that the method is converging into the ideal probability. 






## Task 5 

```{r}
choose(8,4)
```

```{r}
1-ppois(q=4 , lambda=2)
```

### P(Y=10),Y~NegBin(p=0.4,r=3) 
```{r}
choose(8,4)*0.4^3*0.4^(10-3)

```

####	P(Yâ‰¤8),Y~Bin(n=15,p=0.4)

```{r}
1 - pnbinom(q=8,size=15,prob=0.4)
```

## Task 6

```{r}
library(FALL224753bate0046)
mysample(n=200, 1, 10)
```


```{r}

```
